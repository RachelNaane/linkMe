name: Docker Image CI

on:
  push:
    branches: [ "main" ]

jobs:

  CI:

    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v3
      with:
        fetch-depth: 0
    
    #- name: Build Docker image
     # run: docker build . --file Dockerfile --tag app
      
    #- name: E2E test
     # run: |
      #  export APP_IMAGE=app
       # docker compose up -d
        #chmod +x ./tests/e2e-test.sh
        #./tests/e2e-test.sh localhost:80
    
    - name: Git Semantic Version
      id: version
      uses: PaulHatch/semantic-version@v5.0.3
      with:
        tag_prefix: ""
        version_format: "${major}.${minor}.${patch}"
        
    - name: Git Credentials
      uses: oleksiyrudenko/gha-git-credentials@v2-latest
      with:
        token: '${{ secrets.GITHUB_TOKEN }}'
        
    - name: Tag commit
      uses: actions-ecosystem/action-push-tag@v1
      with:
        tag: ${{ steps.version.outputs.version_tag }}
        message: new release - version ${{ steps.version.outputs.version_tag }}'
   

